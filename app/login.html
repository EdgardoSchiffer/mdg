<!DOCTYPE html>
<html>
<head>
	<title>Page Title</title>

	<meta name="viewport" content="width=device-width" content="height=device-height" charset="UTF-8">
<link rel="stylesheet" href="css/mdg.min.css" />
<link rel="stylesheet" type="text/css" href="css/mobipick.css">
		<link rel="stylesheet" href="css/jquery.mobile.icons.min.css" />
		<link rel="stylesheet" href="css/jquery.mobile.structure-1.4.5.min.css" />
		<script src="js/jquery.js"></script>
		<script src="js/jquery.mobile-1.4.0-rc.1.js"></script>
<script type="text/javascript" src="js/xdate.js"></script>
<script type="text/javascript" src="js/mobipick.js"></script>
<script type="text/javascript" src="js/jqm-spinbox.min.js"></script>
<link rel="stylesheet" type="text/css" href="css/jquery.timepicker.min.css">
<script type="text/javascript" src="js/jquery.timepicker.min.js"></script>
<script type="text/javascript">
	$( document ).on( "pagecreate", "#reservacion", function() {
	var today = new Date();
	var dd = today.getDate();
	var mm = today.getMonth()+1; //January is 0!
	var yyyy = today.getFullYear();
	if(dd<10) {
	    dd='0'+dd
	} 
	if(mm<10) {
	    mm='0'+mm
	} 
	today = yyyy+'-'+mm+'-'+dd;	
	document.getElementById("fecha").setAttribute("min", today);
    var picker = $( "input[type='date']", this );
    $('#hora').timepicker({
    	 timeFormat: 'HH:mm',
    	 minTime: '08:00:00',
    	 maxTime: '21:00:00',
    	 interval: 30
    });
    picker.mobipick({
    	locale: "ES"
    });
});
	function logout(){
		localStorage.clear();
		sessionStorage.clear();
		$.mobile.changePage( "#login" , { role: "page" } );
	}
	$( "document" ).ready(function(){
		if (sessionStorage.getItem('usuario') == null) {
			$.mobile.changePage( "#login" , { role: "page" } );
		};
		if (sessionStorage.getItem('usuario') != null) {
			$.mobile.changePage( "#principal" , { role: "page "});
		};
	});
</script>
</head>

<style type="text/css">
	
	#cajas{

		width: 100%;


	}

	#logg{
        
		font-family: Andalus;
		font-size: 20px;
		color: blue;

	}
	.lis{
		padding: 2px;
		width: 95%;
		border-radius: 12%;
	}
	#buscarc{
       border: none;
       margin-bottom: 10px;
		margin-left: 60%;
		padding-bottom: 2px;
	}
	.text{
		color: white;
		padding: 3px;
	}

	.popup{
		background: #333846;
		width: 200px;
		height: 20%;
		box-shadow: 5px 5px 20px black;
		text-align: center;
	}
</style>
<body >



<div data-role="page" data-theme="a" id="login">
	<div data-role="header"  data-theme="a">
			<a href="../index.html" rel="external" data-role="button" data-icon="arrow-l" data-iconpos="notext" data-theme="a" data-iconshadow="false" data-inline="true"></a>
	</div>
	<script type="text/javascript">
			$(document).ready(function(){
				$("#btnlogin").click(function(){
					if (validarLogin() == true) {
						var url = "http://172.16.196.221/MesondeGoya/php/login.php";
						$.getJSON(url ,{correo:$("#email").val(), pass:$("#pwd").val()}, mostrarDatos);
					}
				});
			});
			function mostrarDatos(datos){
				if (datos.rol == "Cliente") 
			    {	  
                    
			        sessionStorage.setItem("usuario", $("#email").val());	
			    	$.mobile.changePage( "#principal" , { role: "page" } );
		         } 
			    else{
					$("#logtg").text("Credenciales no encontradas.");
				}
			}

	</script>
	<div data-role="content" >
		<p>
		    <center><img src="Imagenes/Meson.png" width="250" height="75"></center>
		    <br>

			<center><div align="center" data-role="button" id="logtg" data-theme="a"> </div></center>
			<br>
			<br>
			<center>
		    <form role="form" name="login">
                 <center>
				  <div class="form-group">
				  <div id="cajas">
					    
					    <input type="email" class="form-control" id="email" placeholder="Correo" name="email" data-theme="a" onblur="loginCorreo('login', 'email');">
					</div>
				  </div>
				  </center>
                 <center>
				  <div class="form-group">
				    <div id="cajas">
					    
					    <input type="password" class="form-control" id="pwd" name="pwd" placeholder="Contraseña" data-theme="a" onblur="">
					</div>

				  </div>
				  </center>
                   <center>
                   <p>
				  <input  type="button"  id="btnlogin" name="btnlogin" value="Iniciar Sesion" data-theme="a" data-icon="check"  /> 
                  <input  type="button" value="Crear cuenta" data-theme="a" data-icon="edit" onClick="$.mobile.changePage( '#registro' , { role: 'page' } );" /> 
                  </p>
                 </center>
            </form>
            <script type="text/javascript">

			    function validarLogin(){
			     	if (document.forms["login"]["email"].value == "") {
			     		$('#txtLog').html("Ingrese su correo");
			     		$('#popLogin' ).popup('open');
			     		return false;
			     	};
			     	if (document.forms["login"]["pwd"].value == "") {
			     		$('#txtLog').html("Ingrese su contraseña");
			     		$('#popLogin' ).popup('open');
			     		return false;
			         };
			         return true;
			    }
				function loginCorreo(){
					var campo = document.forms['login']['email'].value;
					var atpos = campo.indexOf("@");
					var dotpos = campo.lastIndexOf(".");
					if (atpos< 1 || dotpos<atpos+2 || dotpos+2>=x.length) {
					    $('#txtLog').html("Correo mal escrito");
					    $('#popLogin' ).popup('open');
					    return false;
					}
				}
			</script>
			<div data-role="popup" id="popLogin" data-overlay-theme="a" class="popup">
		         <div id="txtLog"></div>
		 	</div>
           </center>
			
		</p>
	</div><!-- /content -->
	<br>
	<br>
	<div data-role="footer" data-theme="a" style="position: fixed; bottom:0; left:0; right:0; margin-top=20px;">
		<h4>Meson de Goya &copy;</h4>
	</div><!-- /footer -->

</div><!-- /page -->